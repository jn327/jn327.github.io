<!DOCTYPE html>
<html lang = "en"> <!-- language flag, used by screen readers -->
<head>
  <meta charset = "uft-8" /> <!-- character set definition -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2, minimum-scale=0.5">

  <title>Josh Newland's page</title>
  <!-- imports  CSS definitions with media queries-->
  <link rel= "stylesheet" href ="styles/shared.css">
  <link rel= "stylesheet" href ="styles/topBar.css">

  <link rel= "stylesheet" href ="styles/index.css">

</head>
<body>

  <canvas id="bgCanvas" class="fullFixed"></canvas>
  <canvas id="mgCanvas" class="fullFixed"></canvas>
  <canvas id="fgCanvas" class="fullFixed"></canvas>

  <div id="contentContainer">
    <div id="labelsContainer">
    <!-- <img id="meImage" src="images/me.png" alt=""> -->

      <p id="headerLabel" >Hi, I'm Josh Newland</p>
      <p id="descriptionLabel" >I'm a software programmer from the UK, with an interest in games development, procedural generation & good stories</p>
      <a class="standardButton" href="https://docs.google.com/document/d/1aoY__ax24UL680VNK6I426u9ZPTJPOzOeF7xRY3nEOI/edit?usp=sharing" target="_blank" >Check out my CV</a>
    </div>
  </div>

  <script src="scripts/Utils/Vector2d.js"></script>
  <script src="scripts/Utils/MathEx.js"></script>
  <script src="scripts/Utils/ColorUtil.js"></script>

  <script src="scripts/GameLoop.js"></script>
  <script src="scripts/MouseTracker.js"></script>
  <script src="scripts/CanvasScaler.js"></script>

  <script src="scripts/CommonElementsCreator.js"></script>
  <script> createHeaderElement(document.body, 0); </script>

  <script>

  // maybe for https://www.reddit.com/r/proceduralgeneration/comments/apyz31/challenge_2019_1_procedural_garden/
  // some examples:
  //https://brandio.github.io/ProceduralCactus/
  //https://dattasid.github.io/flowers/flowers.html

  //HTML Elements
  var bgCanvas, bgCtx;
  var mgCanvas, mgCtx;
  var fgCanvas, fgCtx;

  //variables
  var dayDur     = 30;
  var dayTimer   = 0;
  var tod        = 0; //0-1

  var skyUpdateFreq   = 0.2;
  var skyUpdateTimer  = 0;
  var skyPixelSize    = 6;
  var sunRiseTime     = 0.1;
  var sunSetTime      = 0.7;
  var skyColorDay     = [163, 225, 255];
  var skyColorNight   = [0, 0, 0];

  //------------------------------------------------
  //                    Start
  //------------------------------------------------
  function start()
  {
    initCanvas();

    updateSkyVisuals();
  }

  function initCanvas()
  {
    bgCanvas  = document.getElementById("bgCanvas");
    bgCtx     = bgCanvas.getContext('2d');

    mgCanvas  = document.getElementById("mgCanvas");
    bgCtx     = bgCanvas.getContext('2d');

    fgCanvas  = document.getElementById("fgCanvas");
    fgCtx     = bgCanvas.getContext('2d');

    validateCanvasSize();
  }

  function validateCanvasSize()
  {
    var bTrue = false;

    if(CanvasScaler.updateCanvasSize( bgCanvas ))
    {
      bTrue = true;
    }
    if(CanvasScaler.updateCanvasSize( mgCanvas ))
    {
      bTrue = true;
    }
    if(CanvasScaler.updateCanvasSize( fgCanvas ))
    {
      bTrue = true;
    }

    return bTrue;
  }

  //------------------------------------------------
  //                    Update
  //------------------------------------------------
  function update()
  {
    //update the current time of day.
    dayTimer += GameLoop.deltaTime;
    if (dayTimer > dayDur)
    {
      dayTimer = 0;
    }
    tod = dayTimer / dayDur;

    //update the sky. If it needs it.
    skyUpdateTimer += GameLoop.deltaTime;
    if (skyUpdateTimer > skyUpdateFreq)
    {
      skyUpdateTimer = 0;
      updateSkyVisuals();
    }
  }

  function updateSkyVisuals()
  {
    var bSunVisible = tod > sunRiseTime && tod < sunSetTime;
    //if the sun is visible, how far into the daytime is it...
    if (bSunVisible)
    {
      var sunPosNormal = Math.minMaxNormal(tod, sunRiseTime, sunSetTime);
    }

    var todLerp = 0.5 + (Math.cos(tod * 2 * Math.PI) * 0.5);
    var todColor = ColorUtil.lerp(skyColorDay, skyColorNight, todLerp);
    todColor = ColorUtil.rgbToHex(todColor);

    for ( var x = 0; x < bgCanvas.width; x += skyPixelSize )
    {
      for ( var y = 0; y < bgCanvas.height; y+= skyPixelSize )
      {
        bgCtx.fillStyle = todColor;
        bgCtx.fillRect(x,y,skyPixelSize,skyPixelSize);
      }
    }
  }

  //------------------------------------------------
  //                    Mouse events
  //------------------------------------------------
  function onMouseDown()
  {

  }

  </script>

</body>
</html>
